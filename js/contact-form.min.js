const formLoadTime = Date.now();
async function sendCVRequest(e) {
  e.preventDefault();
  const t = document.getElementById('cv-form'),
    n = document.getElementById('submit-btn'),
    l = document.getElementById('btn-text'),
    s = document.getElementById('btn-loading'),
    o = document.getElementById('cv-confirm'),
    c = document.getElementById('success-msg'),
    i = document.getElementById('error-msg'),
    d = new FormData(t),
    r = document.getElementById('cv-name').value.trim(),
    a = document.getElementById('cv-email').value.trim(),
    m = document.getElementById('cv-subject').value.trim(),
    y = document.getElementById('cv-message').value.trim(),
    u = document.getElementById('botcheck').value;
  if (!(r && a && m && y)) return (alert('Please fill all fields before sending the request.'), !1);
  if (u) return (console.warn('Bot detected: honeypot filled'), !1);
  if (Date.now() - formLoadTime < 800)
    return (console.warn('Bot detected: form submitted too quickly'), !1);
  const f = /<script|javascript:|onerror=|onclick=/i;
  if (f.test(r) || f.test(m) || f.test(y))
    return (alert('Invalid input detected. Please remove any special characters or scripts.'), !1);
  ((n.disabled = !0),
    (l.style.display = 'none'),
    (s.style.display = 'inline'),
    (o.style.display = 'none'));
  try {
    const e = await fetch('https://api.web3forms.com/submit', { method: 'POST', body: d });
    if (!(await e.json()).success) throw new Error('Submission failed');
    ((c.style.display = 'block'),
      (i.style.display = 'none'),
      (o.style.display = 'block'),
      t.reset(),
      setTimeout(() => {
        t.querySelectorAll('label').forEach((e) => e.classList.remove('active'));
      }, 100));
  } catch (e) {
    (console.error('Error:', e),
      (c.style.display = 'none'),
      (i.style.display = 'block'),
      (o.style.display = 'block'));
  } finally {
    ((n.disabled = !1), (l.style.display = 'inline'), (s.style.display = 'none'));
  }
  return !1;
}
